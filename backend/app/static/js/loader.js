(()=>{var e={857:(e,t)=>{"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.LANGUAGE_TO_LOCALE_MAPPING=t.LanguageCode=void 0,(a=t.LanguageCode||(t.LanguageCode={})).DEFAULT="en",a.EN="en",a.ES="es",a.PT="pt",a.JP="jp",a.TW="tw",a.FR="fr",t.LANGUAGE_TO_LOCALE_MAPPING={en:"en",es:"es",pt:"pt",jp:"ja",tw:"zh_TW",fr:"fr"}},21:(e,t,a)=>{const{LanguageCode:n}=a(857),r=Object.freeze({"aws.amazon.com":function(){const e=window.location.pathname.split("/");if(e.length<2)return null;const t=e[1];return 2===t.length?t.toLowerCase():null}});e.exports={getExperimentalFeatures:function(){const e=localStorage.getItem("cb-experimentalFeatures");return e&&"string"==typeof e?JSON.parse(e):[]},getLanguageCodeFromPage:function(){const e=window.location.hostname;let t;const a=r[e];return t=a?a():function(e){let t=e?.split("/")?.find((e=>e.match("^[a-z]{2}$")))?.toLowerCase();return t??n.EN}(e+window.location.pathname),Object.values(n).includes(t)?t:n.EN},LanguageCode:n,isNetworkError:function(e){return"Failed to fetch"===e.message||"Load failed"===e.message||"The operation was aborted. "===e.message},isExpectedError:function(e){return"Unexpected end of JSON input"===e.message||"returnfalse is not defined"===e.message||e.message.includes("Cannot destructure property")||e.message.includes("Unexpected token")||e.message.includes("Unexpected end of JSON input")||e.message.includes("r.data is undefined")}}},330:(e,t,a)=>{const{getExperimentalFeatures:n,getLanguageCodeFromPage:r,isNetworkError:o,isExpectedError:s}=a(21),{LANGUAGE_TO_LOCALE_MAPPING:i,LanguageCode:c}=a(857),u=["alpha","beta","gamma","prod"],g="CHAT_LOADER_",l=`${g}AVAILABILITY`,d=`${g}COMPATIBILITY_ISSUE_COUNT`,m=`${g}TOAST_MESSAGE_CONFIG_FAILURE_COUNT`,f=`${g}NETWORK_FAILURE_COUNT`,h=`${g}EXPECTED_FAILURE_COUNT`,p=["ValidationException","ThrottlingException"];let T,w;const y="cb-toast-message-config",O="cb-trafficPercentage",S="disable_chat_ui";async function b(){try{await async function(){if(n().includes(S))return void console.log(`Chat UI disabled due to "${S}" experimental feature.`);const e=function(){const e=document.getElementById("mrc-sunrise-chat-loader")?.getAttribute("src");if(!e)return console.error("Missing required document element for chat script."),null;const t=e.split(".").slice(2,3).pop();return u.includes(t)?t:(console.error(`Unsupported stage value: ${t}`),null)}();if(!e)return;!function(e){const t="https",a="mrc-sunrise.marketing.aws.dev",n="us-east-1";T=`${t}://infra-api.${n}.${e}.${a}/custom-metric`,w=`${t}://chatbot-api.${n}.${e}.${a}/health-check`}(e);const t=window.location.hostname+window.location.pathname;if(!await async function(e){return!!localStorage||(await E(d,1,{logType:"INFO",messageObj:{hostname:e,message:"Browser HTML web storage, localStorage is null",userAgent:navigator.userAgent}}),!1)}(t))return;const{chatConfig:a,languageSupportedFeatures:g,theme:f,trafficPercentage:b,openonvisit:v,alwayson:C,headers:F,featureFlagMap:A,unauthTheme:I,unauthThemeTrafficPercentage:L,igniteSupportedFeatures:M,igniteTrafficPercentage:_,chatbotRoutingTreatment:R,toastMessageConfig:x}=await async function(){const e=window.location.hostname+window.location.pathname,t={hostname:e,languageCode:r()};let a,n;try{a=await fetch(w,{method:"POST",body:JSON.stringify(t)})}catch(t){return void await P(t,e)}try{n=await a.json();const r=n.error;if(r)return"The input fails to satisfy the constraints specified"===r.message&&await E(l,0,{logType:"ERROR",messageObj:{hostname:e,message:"Healthcheck returned invalid request exception",healthCheckParam:t,errorMessage:r.message}}),void p.includes(r.name);const{config:o,languageSupportedFeatures:s,theme:i,trafficPercentage:c,openonvisit:u,alwayson:g,headers:d,featureFlagMap:m,unauthTheme:f,unauthThemeTrafficPercentage:h,igniteSupportedFeatures:T,igniteTrafficPercentage:w,chatbotRoutingTreatment:y,toastMessageConfig:O}=n.data;if(!(o&&Object.keys(o).length&&s&&Object.keys(s).length))throw new Error(`Invalid Healthcheck response body: ${JSON.stringify(n)}`);return{chatConfig:o,languageSupportedFeatures:s,theme:i,trafficPercentage:c,openonvisit:u,alwayson:g,headers:d,featureFlagMap:m,unauthTheme:f,unauthThemeTrafficPercentage:h,igniteSupportedFeatures:T,igniteTrafficPercentage:w,chatbotRoutingTreatment:y,toastMessageConfig:O}}catch(a){return o(a)?void await P(a,e):s(a)?void await async function(e,t){return await E(h,1,{logType:"INFO",messageObj:{errorName:e.name,errorMessage:e.message,hostname:t,userAgent:navigator.userAgent}})}(a,e):void await E(l,0,{logType:"ERROR",messageObj:{hostname:e,message:"Error faced when parsing response",errorName:a.name,errorMessage:a.message,healthCheckRequest:JSON.stringify(t),healthCheckResponse:JSON.stringify(n)}})}}()||{};if(a&&g&&function(e,t=1){return 1===t||e<t}(function(){let e;const t=localStorage.getItem(O);if(t){const a=JSON.parse(t);e="number"!=typeof a?.expiryTimestamp||a.expiryTimestamp<Date.now()?N():parseFloat(a.generatedPercentage)}else e=N();return e}(),b)){(function(e){localStorage.setItem("cb-featureFlagMap",JSON.stringify(e))})(A),await async function(e,t){try{if(!e)return void localStorage.removeItem(y);const t=JSON.stringify(e);if(!t)throw new Error(`Invalid toast message config type: ${e}`);localStorage.setItem(y,t)}catch(e){await E(m,1,{logType:"ERROR",messageObj:{hostname:t,message:"Failed to store toast message configuration",errorName:e.name,errorMessage:e.message}})}}(x,t);try{!function({chatConfig:e,languageSupportedFeatures:t,theme:a,openonvisit:n,alwayson:r,headers:o,unauthTheme:s,unauthThemeTrafficPercentage:u,igniteSupportedFeatures:g,igniteTrafficPercentage:l,chatbotRoutingTreatment:d}){let m=document.getElementById("mrc-sunrise-chat");m||(m=document.createElement("div"),m.id="mrc-sunrise-chat",document.body.appendChild(m)),function({chatMountingPoint:e,languageSupportedFeatures:t,theme:a,openonvisit:n,alwayson:r,unauthTheme:o,unauthThemeTrafficPercentage:s,igniteSupportedFeatures:u,igniteTrafficPercentage:g,chatbotRoutingTreatment:l}){(function(e,t){let a;if(e.dataset.language)a=e.dataset.language;else{const n=window.location.pathname?.split("/")[1];a=Object.keys(t).indexOf(n)>-1?n:c.DEFAULT,e.dataset.language=a}e.dataset.locale||(e.dataset.locale=i[a]);const n=t[a]||{},r=Object.keys(n);for(let t=0;t<r.length;t++){const a=r[t],o=`${a}Enabled`;e.dataset[o]||(e.dataset[o]=n[a])}})(e,t),function(e,t){t&&!e.dataset.theme&&("webview-blue"===t?(e.dataset.theme="blue",e.dataset.webview="true",e.dataset.eventApp="true",e.dataset.alwayson="true"):e.dataset.theme=t)}(e,a),function(e,t,a){t&&!e.dataset.unauththeme&&(e.dataset.unauthTheme=t),a&&!e.dataset.unauthThemeTrafficPercentage&&(e.dataset.unauthThemeTrafficPercentage=a)}(e,o,s),function(e,t){e.dataset.openonvisit=e.dataset.openonvisit||t?"true":"false"}(e,n),function(e,t){e.dataset.alwayson=e.dataset.alwayson||t?"true":"false"}(e,r),function(e,t,a){t&&(e.dataset.igniteSupportedFeatures=JSON.stringify(t)),void 0!==a&&(e.dataset.igniteTrafficPercentage=a)}(e,u,g),l&&(e.dataset.chatbotRoutingTreatment=l)}({chatMountingPoint:m,languageSupportedFeatures:t,theme:a,openonvisit:n,alwayson:r,unauthTheme:s,unauthThemeTrafficPercentage:u,igniteSupportedFeatures:g,igniteTrafficPercentage:l,chatbotRoutingTreatment:d}),localStorage.setItem("cb-config",JSON.stringify(e));const f=document.createElement("script");f.src=e.chatAppScriptPath,f.defer="defer",document.body.appendChild(f),function(e){const t=e?.cloudFrontCountry;localStorage.setItem("cb-headers",JSON.stringify({...t&&{cloudFrontCountry:t}}))}(o)}({chatConfig:a,languageSupportedFeatures:g,theme:f,openonvisit:v,alwayson:C,headers:F,unauthTheme:I,unauthThemeTrafficPercentage:L,igniteSupportedFeatures:M,igniteTrafficPercentage:_,chatbotRoutingTreatment:R})}catch(e){return void await E(d,1,{logType:"INFO",messageObj:{errorName:e.name,errorMessage:e.message,hostname:t,message:"Mount chat script failed",userAgent:navigator.userAgent}})}await E(l,1,{logType:"INFO",messageObj:{hostname:t,message:"Chat script loaded"}})}}()}catch(e){}}const E=async(e,t,a)=>{try{await fetch(T,{method:"POST",body:JSON.stringify({metrics:[{metric:{name:e,value:t,unit:"Count"},logMessage:a}],namespace:"ChatUi"})})}catch(e){}};function N(){const e=Math.random();return localStorage.setItem(O,JSON.stringify({generatedPercentage:e,expiryTimestamp:Date.now()+432e5})),e}async function P(e,t){return await E(f,1,{logType:"INFO",messageObj:{errorName:e.name,errorMessage:e.message,hostname:t,userAgent:navigator.userAgent}})}b(),"object"==typeof process&&(e.exports=b)}},t={};!function a(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,a),o.exports}(330)})();